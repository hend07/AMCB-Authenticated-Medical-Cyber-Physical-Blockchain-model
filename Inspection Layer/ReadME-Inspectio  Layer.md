# ðŸ§© Inspection Layer â€“ README

## ðŸŽ¯ Overview
The **Inspection Layer** serves as an internal **AI Forensic Checkpoint** that validates and cross-examines every analytical decision generated by the lower layers. It ensures that only consistent and verified outputs proceed toward blockchain logging or physical execution.

This layer adopts a **"trust-but-verify"** security paradigmâ€”designed to reduce the risk of **false acceptance, model evasion, drift attacks, and adversarial bypass attempts**.

---

## ðŸ” Functional Workflow
1. **Input Reception** â€“ The layer receives a flagged record, event, or transaction from the **Fog/Analytical Layer**.
2. **Scenario Selection** â€“ Depending on the input type (network flow, executable file, or APK), the layer dynamically triggers one of the benchmark **ML Test Scenarios**.
3. **Cross-Validation** â€“ The decision is compared between:
   - A **Baseline Model** (static, verified model used as reference)
   - An **Adaptive Model** (dynamically updated through continuous learning)
4. **Decision Logic:**
   - âœ… **Match Confirmed** â†’ Forward to Blockchain Layer or Active Response Layer.
   - ðŸ” **Retraining Required** â†’ Send back to the continuous training pipeline.
   - ðŸš¨ **Alert & Block** â†’ Flag as a security incident and quarantine for forensic review.

---

## ðŸ§ª ML Test Scenarios Integrated into Inspection Layer

| # | Test Scenario Title | Description | Dataset Source | Objective |
|---|---------------------|-------------|----------------|-----------|
| 1 | **ML Test Model for IoT Intrusion Detection** | Detects abnormal communication in IoT networks using flow-based features. | PCAP / Flow Datasets | Identify intrusions or spoofed network sessions. |
| 2 | **ML Test Model for Malware Detection for Portable Executable Files** | Analyzes raw PE binaries to extract malicious patterns at binary-level. | PE Raw Binary Dataset | Detect harmful Windows executables before execution. |
| 3 | **ML Test Model for PE Headers Malware Detection** | Performs lightweight malware screening using PE header metadata only. | PE Header / Metadata | Enable ultra-fast pre-execution filtering. |
| 4 | **ML Test Model for Android Malware Detection** | Uses opcode and permission analysis to classify Android APK threats. | APK / DEX Static Features | Secure IoT/Edge Android-based devices from malware. |

---

## âš™ï¸ Automatic Scenario Selection Logic
| Input Type | Triggered Scenario |
|------------|-------------------|
| Network Flow / PCAP Data | Scenario 1 |
| Full Windows PE Binary | Scenario 2 |
| Only PE Header Stream (Metadata) | Scenario 3 |
| APK / DEX Android Application | Scenario 4 |

The orchestration logic ensures **modular plug-and-play integration** for future models without restructuring the core pipeline.

---

## ðŸ§  AI Validation & Drift Monitoring
- Every scenario generates a **Confidence Vector**, comparing the classification confidence between the **Baseline Model** and the **Adaptive Model**.
- If the deviation exceeds a defined **Drift Threshold**, the event is tagged as **Drift Suspicion** and queued for retraining.
- This process turns the Inspection Layer into an **Adaptive Forensic Consistency Engine**, enforcing long-term model stability in live CPS environments.

---

## ðŸ“Ž Source & Attribution Notice
Some verification modules within this layer incorporate **open-source code fragments from Kaggle projects**, which were carefully **refactored, modularized, and integrated** into the unified Inspection Layer architecture.

- âœ… All reused components are strictly employed for **research and benchmarking purposes**.
- âœ… Attribution and original logic references are retained in code comments.
- âœ… A dedicated `attribution.md` file documents original Kaggle sources to ensure reproducibility and academic transparency.

---

> ðŸ§© *The Inspection Layer ensures forensic-grade validation, consistency reinforcement across ML decisions, and adaptive learning integrity â€” forming a critical checkpoint in the multi-layer CPS security architecture.*

